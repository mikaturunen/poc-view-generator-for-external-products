!function(){"use strict";function e(e,t){for(var n,o,r,i=0,l=0,u=0;u<=e.length;u++){var c=e.charCodeAt(u);if(c===a||c===s||!c){if(0===i)n=0===u?"div":c?e.substring(l,u):e;else{var d=e.substring(l,u);1===i?o=d:r?r+=" "+d:r=d}l=u+1,i=c===a?1:2}}var f=t?document.createElementNS(t,n):document.createElement(n);return o&&(f.id=o),r&&(f.className=r),f}function t(e){return document.createTextNode(e)}function n(e,t,n){var o=e.el||e,r=t.el||t;r.__redom_list&&(r=r.el),t===r&&r.__redom_view&&(t=r.__redom_view),t!==r&&(r.__redom_view=t),t.isMounted?t.remount&&t.remount():t.mount&&t.mount(),n?o.insertBefore(r,n.el||n):o.appendChild(r),t.isMounted?t.remounted&&t.remounted():(t.isMounted=!0,t.mounted&&t.mounted())}function o(e,t){var n=e.el||e,o=t.el||t;t===o&&o.__redom_view&&(t=o.__redom_view),t.unmount&&t.unmount(),n.removeChild(o),t.isMounted=!1,t.unmounted&&t.unmounted()}function r(o){var r,i=arguments;if("string"==typeof o)r=(l[o]||(l[o]=e(o))).cloneNode(!1);else{if(!o||!o.nodeType)throw new Error("At least one argument required");r=o.cloneNode(!1)}for(var a=!0,s=1;s<arguments.length;s++){var u=i[s];if(u)if("function"==typeof u)u(r);else if("string"==typeof u||"number"==typeof u)a?(a=!1,r.textContent=u):r.appendChild(t(u));else if(u.nodeType||u.el&&u.el.nodeType)a=!1,n(r,u);else if(u.length){a=!1;for(var c=0;c<u.length;c++)n(r,u[c])}else if("object"==typeof u)for(var d in u){var f=u[d];if("style"===d)if("string"==typeof f)r.setAttribute(d,f);else for(var h in f)r.style[h]=f[h];else d in r||"function"==typeof f?r[d]=f:r.setAttribute(d,f)}}return r}function i(e,t){for(var r=e.el||e,i=r.firstChild,a=0;a<t.length;a++){var s=t[a];if(s){var l=s.el||s;l!==i?n(e,s,i):i=i.nextSibling}}for(;i;){var u=i.nextSibling;o(e,i),i=u}}var a="#".charCodeAt(0),s=".".charCodeAt(0),l={};r.extend=function(t){var n=l[t]||(l[t]=e(t));return r.bind(this,n)};var u=function(e,t){this.el="string"==typeof e?r(e):e,this.Views=t};u.prototype.update=function(e,t){if(e!==this.route){var n=this.Views,o=n[e];this.view=o&&new o,this.route=e,i(this.el,[this.view])}this.view&&this.view.update&&this.view.update(t)};var c=function(){};c.generateHandler=function(e,t,n,o,r){return function(){try{if(e.readyState===XMLHttpRequest.DONE&&200==e.status)if(""!==e.response){var i=JSON.parse(e.response);o(i.body?i.body:i)}else o()}catch(e){console.log("Error with the request "+t+", "+n+". "+e),r()}}},c.GET=function(e){return new Promise(function(t,n){var o=new XMLHttpRequest;console.log("Making a GET call to "+e),o.onreadystatechange=c.generateHandler(o,"GET",e,t,n),o.open("GET",e),o.send()})},c.POST=function(e,t){return new Promise(function(n,o){var r=new XMLHttpRequest;console.log("Making a POST call to "+e);var i=JSON.stringify(t);r.onreadystatechange=c.generateHandler(r,"POST",e,n,o),r.open("POST",e,!0),r.setRequestHeader("Content-type","application/json"),r.send(i)})};var d=function(e,t,o){var i=this;console.log("Starting to build UI from the JSON:",e),this.saveEndpoint=o?o:e.endpoint,this.generatorForm=r("form"),n(t,this.generatorForm),e.ui.forEach(function(e){return i.generateElementFromDescription(e)})};d.prototype.generateElementFromDescription=function(e){var t=this;console.log("Element: ",e);var o;switch(e.html){case"fieldset":o=r(e.html,{legend:e.legend});break;case"label":o=r(e.html,{for:e.for},e.value);break;case"span":o=r(e.html,{},e.value);break;case"input":o="checkbox"===e.type?r("div",r("input",{type:"checkbox",id:e.id}),r("label.label-inline",{for:e.id},e.value)):r(e.html,{type:e.type});break;case"button":o=r(e.html,{type:e.type},e.value),"save"===e.meta&&(o.onclick=function(e){console.log("save clicked"),c.POST(t.saveEndpoint,{foo:"bar"})});break;default:console.log("Unsupported element, no support yet implemented for:",e.html,e)}return n(this.generatorForm,o),e.children&&e.children.map(function(e){return t.generateElementFromDescription(e)}).forEach(function(e){return n(o,e)}),o};var f=function(){var e=this;this.el=r(".app",this.header=r("div",r("h2","PoC JSON Renderer")),this.content=r("div"));var t=document.getElementById("GET").getAttribute("endpoint"),n=document.getElementById("POST").getAttribute("endpoint");c.GET(t).then(function(t){e.content=r("div",e.ui=new d(t,h,n))}).catch(console.log)},h=new f;n(document.body,h)}();